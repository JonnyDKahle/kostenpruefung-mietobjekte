{% load static %}
<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <title>Konto</title>
    <link rel="stylesheet" href="{% static 'kostenpruefung_mietobjekte_app/style.css' %}">
</head>
<body>
<div class="flex-container">
    <nav class="sidebar">
        <a class="sidebar-link" href="{% url 'kostenpruefung_mietobjekte_app:objekt_index' %}">Objekt</a>
        <a class="sidebar-link" href="{% url 'kostenpruefung_mietobjekte_app:mieter_laufend' %}">Mieter</a>
        <a class="sidebar-link" href="{% url 'kostenpruefung_mietobjekte_app:rechnungen' %}">Kosten</a>
        <a class="sidebar-link" href="{% url 'kostenpruefung_mietobjekte_app:konto' %}">Konto</a>
        <a class="sidebar-link" href="{% url 'kostenpruefung_mietobjekte_app:auswertung' %}">Auswertung</a>
    </nav>
    <div class="main-content">
        <h2>Alle Kontobewegungen</h2>
        <form action="{% url 'kostenpruefung_mietobjekte_app:konto_create' %}" method="get" style="margin-bottom: 16px;">
            <button class="action-btn" type="submit">Anlegen</button>
        </form>
        
        <!-- Pagination (Top) -->
        {% with konten as page_obj %}
            {% include 'kostenpruefung_mietobjekte_app/partials/pagination.html' %}
        {% endwith %}
        <table class="object-table">
            <tr>
                <th>Buchungstag</th>
                <th>Kontoinhaber</th>
                <th>Betrag</th>
                <th>Buchungstext</th>
                <th>Werterstellung</th>
                <th>Buchungsart</th>
                <th>Mieter</th>
                <th>Lieferanten</th>
                <th>Mietobjekte</th>
                <th>Aktionen</th> <!-- New column for actions -->
            </tr>
            {% for k in konten %}
            <tr>
                <td>{{ k.buchungstag|date:"d.m.Y" }}</td>
                <td>{{ k.kontoinhaber }}</td>
                <td>{{ k.betrag }}</td>
                <td>{{ k.buchungstext }}</td>
                <td>{{ k.werterstellung|date:"d.m.Y" }}</td>
                <td>{{ k.buchungsart }}</td>
                <td>
                    {% for m in k.mieter.all %}
                        {{ m.vorname }} {{ m.nachname }}{% if not forloop.last %},<br>{% endif %}
                    {% endfor %}
                </td>
                <td>
                    {% for l in k.lieferanten.all %}
                        {{ l.firmenname }}{% if not forloop.last %},<br>{% endif %}
                    {% endfor %}
                </td>
                <td>
                    {% for obj in k.mietobjekt.all %}
                        {{ obj.name }}{% if not forloop.last %},<br>{% endif %}
                    {% endfor %}
                </td>
                <td class="objekt-actions"> <!-- Actions column -->
                    <form action="{% url 'kostenpruefung_mietobjekte_app:konto_update' k.id %}" method="get" class="inline-form">
                        <button class="action-btn" type="submit">Bearbeiten</button>
                    </form>
                    <form action="{% url 'kostenpruefung_mietobjekte_app:konto_delete' k.id %}" method="get" class="inline-form">
                        <button class="action-btn" type="submit">LÃ¶schen</button>
                    </form>
                </td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="10">Keine Kontobewegungen vorhanden.</td>
            </tr>
            {% endfor %}
        </table>
        
        <!-- Pagination (Bottom) -->
        {% with konten as page_obj %}
            {% include 'kostenpruefung_mietobjekte_app/partials/pagination.html' %}
        {% endwith %}
    </div>
</div>
</body>
</html>