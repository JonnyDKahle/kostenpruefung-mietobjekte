{% load static %}
<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <title>Objekte</title>
    <link rel="stylesheet" href="{% static 'kostenpruefung_mietobjekte_app/style.css' %}">
    <style>
        .objekt-row-rot    { background-color: #ffe5e5; }
        .objekt-row-blau   { background-color: #e5f0ff; }
        .objekt-row-gruen  { background-color: #e5ffe5; }
        .objekt-row-gelb   { background-color: #fffbe5; }
        .objekt-row-schwarz{ background-color: #eeeeee; }
        .objekt-actions { white-space: nowrap; }
        .objekt-actions form { display: inline; }
        .objekt-actions .action-btn { margin-left: 4px; }
    </style>
</head>
<body>
<div class="flex-container">
    <nav class="sidebar">
        <a class="sidebar-link" href="{% url 'kostenpruefung_mietobjekte_app:objekt_index' %}">Objekt</a>
        <a class="sidebar-link" href="{% url 'kostenpruefung_mietobjekte_app:mieter_laufend' %}">Mieter</a>
        <a class="sidebar-link" href="{% url 'kostenpruefung_mietobjekte_app:rechnungen' %}">Kosten</a>
        <a class="sidebar-link" href="{% url 'kostenpruefung_mietobjekte_app:konto' %}">Konto</a>
        <a class="sidebar-link" href="{% url 'kostenpruefung_mietobjekte_app:auswertung' %}">Auswertung</a>
    </nav>
    <div class="main-content">
        <h2>Alle Objekte</h2>
        <form action="{% url 'kostenpruefung_mietobjekte_app:mietobjekt_create' %}" method="get" style="margin-bottom: 16px;">
            <button class="action-btn" type="submit">Anlegen</button>
        </form>
        <table class="object-table">
            <tr>
                <th>Name</th>
                <th>Straße/Hausnummer</th>
                <th>PLZ</th>
                <th>Ort</th>
                <th>Land</th>
                <th>Kaufdatum</th>
                <th>Kaufpreis</th>
                <th>Darlehen</th>
                <th>Grundschuld</th>
                <th>Mieteinheiten</th>
                <th>Aktionen</th>
            </tr>
            {% for o in objekte %}
            <tr class="objekt-row-{{ o.farbe }}">
                <td>{{ o.name }}</td>
                <td>{{ o.strasse_hausnummer }}</td>
                <td>{{ o.plz }}</td>
                <td>{{ o.ort }}</td>
                <td>{{ o.land }}</td>
                <td>{{ o.kaufdatum }}</td>
                <td>{{ o.kaufpreis }}</td>
                <td>{{ o.darlehen }}</td>
                <td>{{ o.grundschuld }}</td>
                <td>
                    {% for einheit in o.mieteinheiten.all %}
                        {{ einheit.name }}<br>
                    {% empty %}
                        <span style="color: #888;">Keine Mieteinheiten</span><br>
                    {% endfor %}
                    <form action="{% url 'kostenpruefung_mietobjekte_app:mieteinheit_create' o.id %}" method="get" style="margin-top: 8px;">
                        <button class="action-btn" type="submit">Mieteinheit anlegen</button>
                    </form>
                </td>
                <td class="objekt-actions">
                    <form action="{% url 'kostenpruefung_mietobjekte_app:mietobjekt_update' o.id %}" method="get" style="display:inline;">
                        <button class="action-btn" type="submit">Bearbeiten</button>
                    </form>
                    <form action="{% url 'kostenpruefung_mietobjekte_app:mietobjekt_delete' o.id %}" method="post" style="display:inline;">
                        {% csrf_token %}
                        <button class="action-btn" type="submit" onclick="return confirm('Wirklich löschen?');">Löschen</button>
                    </form>
                </td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="11">Keine Objekte vorhanden.</td>
            </tr>
            {% endfor %}
        </table>
    </div>
</div>
</body>
</html>